# Blog API

## üê≥ –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Postgres –≤ Docker

–ï—Å–ª–∏ –≤—ã –µ—â–µ –Ω–µ –∑–Ω–∞–∫–æ–º—ã —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º `Docker`, —Ç–æ —Å–æ–≤–µ—Ç—É—é –æ–∑–Ω–∞–∫–æ–º–∏—Ç—Å—è –ø–æ —Å—Å—ã–ª–∫–µ: [https://www.docker.com/get-started/](https://www.docker.com/get-started/).

–¢–∞–∫ –∂–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—Å—è —Å –æ–±—Ä–∞–∑–æ–º `Postgres` –º–æ–∂–Ω–æ –ø–æ —Å—Å—ã–ª–∫–µ: [https://hub.docker.com/_/postgres](https://hub.docker.com/_/postgres).

–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ `Postgres` –≤ **Docker Container** :

```docker
docker run --name blog-api-db -d -i -t \
-p "5432:5432" \
-e POSTGRES_DB="blog_api" \
-e POSTGRES_USER="root" \
-e POSTGRES_PASSWORD="root" \
-v blog-api-data:/var/lib/postgresql postgres
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

* –§–ª–∞–≥ `-d` –æ–∑–Ω–∞—á–∞–µ—Ç "detach", —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ (–¥–µ–º–æ–Ω–µ), –±–µ–∑ –≤—ã–≤–æ–¥–∞ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª.
* –§–ª–∞–≥ `-i` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –≤–≤–æ–¥ (stdin) –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
* –§–ª–∞–≥ `-t` –ø–æ–¥–∫–ª—é—á–∞–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –Ω–∏–º.
* –§–ª–∞–≥ `-p` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º—ç–ø–ø–∏–Ω–≥–∞ –ø–æ—Ä—Ç–æ–≤ –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –∏ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω–æ–π.
–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, —Å –ø–æ–º–æ—â—å—é `-p "5432:5432"`, –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º, —á—Ç–æ –ø–æ—Ä—Ç *5432* –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ (–∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ `PostgreSQL`) –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É *5432* –Ω–∞ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω–µ.
* `-v blog-api-data:/var/lib/postgresql` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–ª—è `Postgres –ë–î`, –≥–¥–µ: `blog-api-data` - —è—á–µ–π–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –≤–∞—à–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ; `/var/lib/postgresql` - –ø—É—Ç—å –¥–æ –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ `Docker`

### –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ Postgres  

* `POSTGRES_DB` - –∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–ø—Ä–∏–º–µ—Ä: **blog_api**)
* `POSTGRES_USER` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø—Ä–∏–º–µ—Ä: **root**)
* `POSTGRES_PASSWORD` - –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø—Ä–∏–º–µ—Ä: **root**)


> **! –Ø –¥–µ–ª–∞–ª —ç—Ç–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ Docker-–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –º–Ω–µ —Ç–∞–∫ –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ –∏ –±—ã—Å—Ç—Ä–µ–µ. –í—ã –∂–µ –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä Postgres-–∞ –Ω–∞ —Å–≤–æ—é –ª–æ–∫–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É, –Ω–∞—Å—Ç—Ä–æ–π–∏—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**

---

## ‚ö° –ó–∞–ø—É—Å–∫ Express –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1\. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è `.env`. (**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ö–æ–∂–µ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —É–∫–∞–∑—ã–≤–∞–µ—Ç–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ Postgres –∏ –ø–µ—Ä–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (DB_\* `.env` —Ñ–∞–π–ª–µ**)

2\. –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–π. –î–ª—è —ç—Ç–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ `dist/db/`, –∏ –∑–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç migrate.js:
```bash
node migration.js migtare:up --migration ./migtaions/0002_create_post_table.js
```
### ‚ÑπÔ∏è *–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥—ã* :

* `migtare:up` —Å–æ–∑–¥–∞–µ—Ç –º–æ–¥–µ–ª–µ–π –∏–∑ —Ñ–∞–π–ª–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
* `migtare:down` –¥–µ–ª–∞–µ—Ç –æ—Ç–∫–∞—Ç –º–æ–¥–µ–ª–µ–π –∏–∑ —Ñ–∞–π–ª–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
* –ü–∞—Ä–∞–º–µ—Ç—Ä `--migration` —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º. –° –ø–æ–º–æ—â—å—é –Ω–µ–≥–æ –º—ã —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º –∏–∑ –∫–∞–∫–æ–≥–æ —Ñ–∞–π–ª–∞ –±—Ä–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ—Ç–∫–∞—Ç–∞ —Ç–∞–±–ª–∏—Ü

3\. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ `Express`:

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É `dist/`. –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç `index.js` :

```bash
node index.js
```

–í –∫–æ–Ω—Å–æ–ª–∏ –≤—ã –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:

```bash
‚ö°Ô∏è[server]: Server is running at http://localhost:8000
```

–í—Å–µ! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API –Ω–∞–ø—Ä–∏–º–µ—Ä —Å –ø–æ–º–æ—â—å—é `Postman` –∏–ª–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ —Å—Å—ã–ª–∫–µ [http://localhost:8000/docs](http://localhost:8000/docs). 

–ù–æ, —Ç–∞–∫ –∂–µ, –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ë–î mock-–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –î–ª—è —ç—Ç–æ–≥–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã `MockPostsCreate.js` –∏ `MockUsersCreate.ts` –≤ –ø–∞–ø–∫–µ `dist/tests/mocks/` :

```bash
node MockUsersCreate.js && node MockPostsCreate.js
```
